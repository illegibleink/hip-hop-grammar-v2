html
  head
    title #{pageTitle}
    link(rel='stylesheet' href='/style.css')
    script(src='https://js.stripe.com/v3/')
  body(data-stripe-key=stripePublishableKey class=theme || 'light-mode')
    .wrapper
      .header-row
        .header-column.logo-column
          a.home-logo(href='/')
            img(src='/logo-home.svg' alt='Logo' width='40' height='auto')
        .header-column.title-column
          .title-wrapper
            h1 #{pageTitle}
            h2 Explore our collection
        .header-column.logout-column
          a.logout-button(href='/logout') Logout
      .track-container
        if Object.keys(tracklists).length === 0
          p No tracklists available. Please check server configuration.
        else
          each tracklist, tracklistName in tracklists
            - const isPurchased = purchasedTracklists.includes(tracklistName)
            - const sortedTracks = isPurchased ? tracklist.tracks : [...tracklist.tracks].sort((a, b) => a.name.localeCompare(b.name))
            .track-card(data-tracklist-name=tracklistName data-year-span=tracklist.yearSpan data-genres=tracklist.uniqueGenres.join(',') class=(parseInt(tracklist.name.slice(1)) <= 12 ? 'nineties' : 'twenties'))
              .track-info
                h3 #{tracklist.name}
                each track in sortedTracks
                  p.track-name(class=(isPurchased ? 'purchased' : 'locked')) #{track.name}
                  if isPurchased
                    p.artist-release(class='visible') #{track.artists.join(', ')} (#{track.release_date ? track.release_date.slice(0, 4) : 'Unknown'})
              .track-actions
                if isPurchased
                  button.unlocked(disabled) Unlocked
                else
                  button.unlock(data-tracklist-name=tracklistName) Unlock #{tracklist.price === 0 ? '' : `($${tracklist.price.toFixed(2)})`}
      .pagination
        a.pagination-arrow(class=(page > 1 ? '' : 'disabled') href=(page > 1 ? `/tracks?page=${page - 1}` : '#') title='Previous') ←
        span.pagination-dots ...
        a.pagination-arrow(class=(page < totalPages ? '' : 'disabled') href=(page < totalPages ? `/tracks?page=${page + 1}` : '#') title='Next') →
      .cart-modal
        h3 Cart (Max 12)
        .cart-items
        p.cart-total Total: $0
        button.checkout-cart Checkout
        button.close-modal Close
        button.clear-cart Clear Cart
        div#checkout-container(style='display: none; margin-top: 10px;')
      .footer
        a(href='/privacy') Privacy Policy
        a(href='/terms') Terms of Service
        button.theme-toggle(title='Toggle Theme') ☀️
    script(src='/scripts.js')